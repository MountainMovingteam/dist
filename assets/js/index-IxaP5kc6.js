import{d as I,b as _,i as E,n as S,o,c as a,a as s,F as b,a7 as g,U as k,O as w,u as x,S as V,a8 as M,I as A,R as d,T as u,bm as D,bk as L}from"./@vue-HrMasQv8.js";import{c as l,_ as N}from"./index-Db6VnN3C.js";import{E as R,c as U,d as O}from"./element-plus-CXqQ8W6I.js";import"./pinia-KM1LF1CQ.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CNO1fUVn.js";import"./vue-i18n-BvBBS3QZ.js";import"./@intlify-COHHyPI8.js";import"./vue-CE7TxhWI.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-e7foqBra.js";import"./nprogress-Bx-CsPDi.js";import"./axios-Cm0UX6qg.js";import"./qs-Bc-_vL76.js";import"./side-channel-nON-R0av.js";import"./get-intrinsic-B1Ut8WxJ.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-B8G-TZ45.js";import"./hasown-B9bXSDSU.js";import"./call-bind-Aj7T_c8u.js";import"./set-function-length-Ct5B6P4y.js";import"./define-data-property-CUxyvwXF.js";import"./es-define-property-28jGrh5V.js";import"./gopd-O61WwtTx.js";import"./has-property-descriptors-Cvfij9iw.js";import"./object-inspect-CZY0DhK8.js";import"./mitt-DJ65BbbF.js";import"./vue-grid-layout-CDkJeOvw.js";import"./lodash-es-WEemOz_S.js";import"./@vueuse-D31sEaKM.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-CphgU6An.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-FEUMNzka.js";const $=""+new URL("../png/logo-Dbn0Xf_R.png",import.meta.url).href,h="http://47.93.19.22:8000";function q(i){return l.withAuth(l.POST,h+"/api/problem/search",{data:{...i}})}function F(i){return l.withAuth(l.POST,h+"/api/problem/query/answer",{data:{...i}})}function H(){let i=h+"/api/base/getAvatar";return l.withAuth(l.GET,i,{})}const K=i=>(D("data-v-5a9171f8"),i=i(),L(),i),P={class:"chatContainer",style:{"margin-top":"30px"}},z={class:"chatContent",ref:"chatBox"},G={style:{display:"flex"}},X={key:0,class:"avatar"},j=K(()=>s("img",{src:$},null,-1)),J=[j],Q={key:1,style:{display:"block"}},W={class:"robotMessage"},Y={key:0,class:"cardList"},Z=["onClick"],tt={key:1},et={class:"messageTime"},st={style:{display:"flex"}},ot={key:0,style:{display:"block"}},at={class:"userMessage"},it={class:"messageTime"},rt={key:1,class:"avatar"},nt=["src"],ct={class:"sendBox"},lt=I({__name:"index",setup(i){const n=_(""),v=_(""),c=_([]);E(async()=>{await H().then(t=>{v.value="http://47.93.19.22:8000"+t.data.avatar_url}),c.value.push({isRobot:!0,content:"输入问题关键词获取相关问题，点击即可获取回答，例：输入'体验馆'",time:p()}),m()});async function f(){if(!n.value.trim()){R({message:"不能发送空消息！",type:"error"});return}c.value.push({isRobot:!1,content:n.value.trim(),time:p()});const t=await q({keywords:n.value.trim()});if(t.data.num==0||t.status!=200)c.value.push({isRobot:!0,content:"对不起，我无法回答您的问题。如果您输入的是一个完整的问题，请缩略为单个关键词。",time:p()});else{let r=[];for(let e=0;e<t.data.num;e++)t.status==200&&r.push({problem_id:t.data.list[e].problem_id,content:t.data.list[e].content});c.value.push({isRobot:!0,cards:r,time:p(),content:""})}n.value="",m()}function m(){S(()=>{const t=document.getElementById("chatBox");t&&(t.scrollTop=t.scrollHeight)})}function p(){const t=new Date;return`${t.getHours()}:${t.getMinutes()}`}async function T(t){const r=await F({problem_id:t.problem_id});r.status!=200?R({message:"无法获取答案，请稍后重试。",type:"error"}):c.value.push({isRobot:!0,content:r.data.answer,time:p()}),m()}return(t,r)=>(o(),a("div",P,[s("div",z,[(o(!0),a(b,null,g(c.value,(e,B)=>(o(),a("li",{key:B,class:A([e.isRobot?"robot":"user"])},[s("div",G,[e.isRobot?(o(),a("div",X,J)):d("",!0),e.isRobot?(o(),a("div",Q,[s("div",W,[e.cards?(o(),a("div",Y,[(o(!0),a(b,null,g(e.cards,(y,C)=>(o(),a("div",{class:"cardItem",key:C,onClick:pt=>T(y)},u(y.content),9,Z))),128))])):(o(),a("div",tt,[s("span",null,u(e.content),1)]))]),s("span",et,u(e.time),1)])):d("",!0)]),s("div",st,[e.isRobot?d("",!0):(o(),a("div",ot,[s("div",at,[s("span",null,u(e.content),1)]),s("span",it,u(e.time),1)])),e.isRobot?d("",!0):(o(),a("div",rt,[s("img",{src:v.value},null,8,nt)]))])],2))),128))],512),s("div",ct,[k(x(O),{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=e=>n.value=e),placeholder:"输入问题关键词获取相关问题",class:"input-with-select",onKeyup:M(f,["enter"])},{append:w(()=>[k(x(U),{onClick:f,type:"primary"},{default:w(()=>[V("发送")]),_:1})]),_:1},8,["modelValue"])])]))}}),Qt=N(lt,[["__scopeId","data-v-5a9171f8"]]);export{Qt as default};
